[2025-08-20 23:30:21,159] INFO - loading dataset gsm8k
[2025-08-20 23:30:24,673] INFO - loading tokenizer for Qwen/Qwen2.5-7B-Instruct
[2025-08-20 23:30:28,175] INFO - loading Qwen/Qwen2.5-7B-Instruct in **4-bit quantized mode** and QLoRA config
Fetching 4 files:   0%|          | 0/4 [00:00<?, ?it/s]Fetching 4 files:  25%|██▌       | 1/4 [00:23<01:11, 23.79s/it]Fetching 4 files: 100%|██████████| 4/4 [00:23<00:00,  5.95s/it]
[2025-08-20 23:30:54,363] INFO - We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:04<00:12,  4.16s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:09<00:09,  4.66s/it]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:14<00:04,  4.86s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  4.36s/it]Loading checkpoint shards: 100%|██████████| 4/4 [00:17<00:00,  4.46s/it]
[2025-08-20 23:31:12,865] INFO - preparing LoRA config for Qwen/Qwen2.5-7B-Instruct
[2025-08-20 23:31:12,865] INFO - configuring SFT training with Qwen/Qwen2.5-7B-Instruct
Applying formatting function to train dataset:   0%|          | 0/6725 [00:00<?, ? examples/s]Applying formatting function to train dataset:  11%|█         | 732/6725 [00:00<00:00, 7218.81 examples/s]Applying formatting function to train dataset:  22%|██▏       | 1505/6725 [00:00<00:00, 7515.60 examples/s]Applying formatting function to train dataset:  34%|███▍      | 2305/6725 [00:00<00:00, 7732.00 examples/s]Applying formatting function to train dataset:  46%|████▋     | 3118/6725 [00:00<00:00, 7885.33 examples/s]Applying formatting function to train dataset:  59%|█████▉    | 3974/6725 [00:00<00:00, 8122.87 examples/s]Applying formatting function to train dataset:  71%|███████   | 4789/6725 [00:00<00:00, 8128.88 examples/s]Applying formatting function to train dataset:  83%|████████▎ | 5606/6725 [00:00<00:00, 8139.72 examples/s]Applying formatting function to train dataset:  96%|█████████▌| 6429/6725 [00:00<00:00, 8127.39 examples/s]Applying formatting function to train dataset: 100%|██████████| 6725/6725 [00:00<00:00, 7958.76 examples/s]
Adding EOS to train dataset:   0%|          | 0/6725 [00:00<?, ? examples/s]Adding EOS to train dataset:  37%|███▋      | 2487/6725 [00:00<00:00, 24734.98 examples/s]Adding EOS to train dataset:  91%|█████████▏| 6142/6725 [00:00<00:00, 24478.40 examples/s]Adding EOS to train dataset: 100%|██████████| 6725/6725 [00:00<00:00, 24388.44 examples/s]
Tokenizing train dataset:   0%|          | 0/6725 [00:00<?, ? examples/s]Tokenizing train dataset:   3%|▎         | 183/6725 [00:00<00:03, 1811.52 examples/s]Tokenizing train dataset:   6%|▌         | 375/6725 [00:00<00:03, 1870.64 examples/s]Tokenizing train dataset:   8%|▊         | 568/6725 [00:00<00:03, 1894.41 examples/s]Tokenizing train dataset:  11%|█▏        | 760/6725 [00:00<00:03, 1899.96 examples/s]Tokenizing train dataset:  15%|█▍        | 1000/6725 [00:00<00:03, 1688.77 examples/s]Tokenizing train dataset:  18%|█▊        | 1188/6725 [00:00<00:03, 1741.72 examples/s]Tokenizing train dataset:  20%|██        | 1377/6725 [00:00<00:03, 1782.60 examples/s]Tokenizing train dataset:  23%|██▎       | 1563/6725 [00:00<00:02, 1803.84 examples/s]Tokenizing train dataset:  26%|██▌       | 1752/6725 [00:00<00:02, 1827.41 examples/s]Tokenizing train dataset:  29%|██▉       | 1944/6725 [00:01<00:02, 1854.17 examples/s]Tokenizing train dataset:  33%|███▎      | 2191/6725 [00:01<00:02, 1715.46 examples/s]Tokenizing train dataset:  35%|███▌      | 2380/6725 [00:01<00:02, 1757.83 examples/s]Tokenizing train dataset:  38%|███▊      | 2570/6725 [00:01<00:02, 1793.75 examples/s]Tokenizing train dataset:  41%|████      | 2762/6725 [00:01<00:02, 1827.22 examples/s]Tokenizing train dataset:  44%|████▍     | 2953/6725 [00:01<00:02, 1849.25 examples/s]Tokenizing train dataset:  47%|████▋     | 3194/6725 [00:01<00:02, 1715.84 examples/s]Tokenizing train dataset:  50%|█████     | 3381/6725 [00:01<00:01, 1754.59 examples/s]Tokenizing train dataset:  53%|█████▎    | 3570/6725 [00:01<00:01, 1789.43 examples/s]Tokenizing train dataset:  56%|█████▌    | 3758/6725 [00:02<00:01, 1814.04 examples/s]Tokenizing train dataset:  59%|█████▊    | 3945/6725 [00:02<00:01, 1828.52 examples/s]Tokenizing train dataset:  62%|██████▏   | 4191/6725 [00:02<00:01, 1684.83 examples/s]Tokenizing train dataset:  65%|██████▌   | 4379/6725 [00:02<00:01, 1731.48 examples/s]Tokenizing train dataset:  68%|██████▊   | 4567/6725 [00:02<00:01, 1770.22 examples/s]Tokenizing train dataset:  71%|███████   | 4756/6725 [00:02<00:01, 1803.05 examples/s]Tokenizing train dataset:  74%|███████▎  | 4948/6725 [00:02<00:00, 1832.83 examples/s]Tokenizing train dataset:  77%|███████▋  | 5191/6725 [00:02<00:00, 1700.96 examples/s]Tokenizing train dataset:  80%|████████  | 5383/6725 [00:03<00:00, 1755.22 examples/s]Tokenizing train dataset:  83%|████████▎ | 5570/6725 [00:03<00:00, 1784.63 examples/s]Tokenizing train dataset:  86%|████████▌ | 5760/6725 [00:03<00:00, 1813.59 examples/s]Tokenizing train dataset:  88%|████████▊ | 5950/6725 [00:03<00:00, 1836.30 examples/s]Tokenizing train dataset:  92%|█████████▏| 6190/6725 [00:03<00:00, 1692.74 examples/s]Tokenizing train dataset:  95%|█████████▍| 6380/6725 [00:03<00:00, 1743.64 examples/s]Tokenizing train dataset:  98%|█████████▊| 6570/6725 [00:03<00:00, 1785.36 examples/s]Tokenizing train dataset: 100%|██████████| 6725/6725 [00:03<00:00, 1769.81 examples/s]
Truncating train dataset:   0%|          | 0/6725 [00:00<?, ? examples/s]Truncating train dataset: 100%|██████████| 6725/6725 [00:00<00:00, 437727.07 examples/s]
Applying formatting function to eval dataset:   0%|          | 0/748 [00:00<?, ? examples/s]Applying formatting function to eval dataset: 100%|██████████| 748/748 [00:00<00:00, 7760.49 examples/s]
Adding EOS to eval dataset:   0%|          | 0/748 [00:00<?, ? examples/s]Adding EOS to eval dataset: 100%|██████████| 748/748 [00:00<00:00, 22201.04 examples/s]
Tokenizing eval dataset:   0%|          | 0/748 [00:00<?, ? examples/s]Tokenizing eval dataset:  26%|██▌       | 191/748 [00:00<00:00, 1891.81 examples/s]Tokenizing eval dataset:  63%|██████▎   | 471/748 [00:00<00:00, 1867.02 examples/s]Tokenizing eval dataset:  88%|████████▊ | 661/748 [00:00<00:00, 1874.73 examples/s]Tokenizing eval dataset: 100%|██████████| 748/748 [00:00<00:00, 1745.41 examples/s]
Truncating eval dataset:   0%|          | 0/748 [00:00<?, ? examples/s]Truncating eval dataset: 100%|██████████| 748/748 [00:00<00:00, 202226.34 examples/s]
[2025-08-20 23:32:08,887] INFO - starting training with Qwen/Qwen2.5-7B-Instruct on gsm8k
  0%|          | 0/211 [00:00<?, ?it/s]`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`.
  0%|          | 1/211 [00:24<1:26:53, 24.83s/it]  1%|          | 2/211 [00:49<1:25:54, 24.66s/it]  1%|▏         | 3/211 [01:13<1:25:11, 24.58s/it]  2%|▏         | 4/211 [01:38<1:25:26, 24.77s/it]  2%|▏         | 5/211 [02:04<1:25:28, 24.89s/it]  3%|▎         | 6/211 [02:28<1:24:38, 24.78s/it]  3%|▎         | 7/211 [02:53<1:24:12, 24.77s/it]  4%|▍         | 8/211 [03:18<1:23:53, 24.80s/it]  4%|▍         | 9/211 [03:43<1:23:30, 24.81s/it]  5%|▍         | 10/211 [04:07<1:23:16, 24.86s/it]  5%|▌         | 11/211 [04:32<1:22:34, 24.77s/it]  6%|▌         | 12/211 [04:57<1:22:02, 24.74s/it]  6%|▌         | 13/211 [05:22<1:21:45, 24.77s/it]  7%|▋         | 14/211 [05:46<1:21:27, 24.81s/it]  7%|▋         | 15/211 [06:12<1:21:16, 24.88s/it]  8%|▊         | 16/211 [06:36<1:20:33, 24.78s/it]  8%|▊         | 17/211 [07:01<1:19:57, 24.73s/it]  9%|▊         | 18/211 [07:25<1:19:37, 24.75s/it]  9%|▉         | 19/211 [07:50<1:19:10, 24.74s/it]  9%|▉         | 20/211 [08:15<1:18:54, 24.79s/it]                                                    9%|▉         | 20/211 [08:15<1:18:54, 24.79s/it] 10%|▉         | 21/211 [08:40<1:18:30, 24.79s/it] 10%|█         | 22/211 [09:05<1:18:06, 24.79s/it] 11%|█         | 23/211 [09:29<1:17:38, 24.78s/it] 11%|█▏        | 24/211 [09:54<1:16:50, 24.66s/it] 12%|█▏        | 25/211 [10:19<1:16:40, 24.73s/it] 12%|█▏        | 26/211 [10:44<1:16:20, 24.76s/it] 13%|█▎        | 27/211 [11:08<1:16:01, 24.79s/it] 13%|█▎        | 28/211 [11:34<1:15:54, 24.89s/it] 14%|█▎        | 29/211 [11:58<1:15:14, 24.81s/it] 14%|█▍        | 30/211 [12:23<1:14:40, 24.75s/it] 15%|█▍        | 31/211 [12:48<1:14:22, 24.79s/it] 15%|█▌        | 32/211 [13:13<1:14:11, 24.87s/it] 16%|█▌        | 33/211 [13:37<1:13:42, 24.84s/it] 16%|█▌        | 34/211 [14:02<1:13:22, 24.87s/it] 17%|█▋        | 35/211 [14:27<1:12:41, 24.78s/it] 17%|█▋        | 36/211 [14:52<1:12:07, 24.73s/it] 18%|█▊        | 37/211 [15:16<1:11:49, 24.77s/it] 18%|█▊        | 38/211 [15:41<1:11:18, 24.73s/it] 18%|█▊        | 39/211 [16:06<1:11:03, 24.79s/it] 19%|█▉        | 40/211 [16:31<1:10:47, 24.84s/it]                                                   19%|█▉        | 40/211 [16:31<1:10:47, 24.84s/it] 19%|█▉        | 41/211 [16:56<1:10:15, 24.80s/it] 20%|█▉        | 42/211 [17:21<1:10:02, 24.87s/it] 20%|██        | 43/211 [17:45<1:09:24, 24.79s/it] 21%|██        | 44/211 [18:10<1:08:54, 24.76s/it] 21%|██▏       | 45/211 [18:35<1:08:20, 24.70s/it] 22%|██▏       | 46/211 [18:59<1:07:58, 24.72s/it] 22%|██▏       | 47/211 [19:24<1:07:51, 24.83s/it] 23%|██▎       | 48/211 [19:49<1:07:35, 24.88s/it] 23%|██▎       | 49/211 [20:14<1:07:10, 24.88s/it] 24%|██▎       | 50/211 [20:39<1:06:50, 24.91s/it] 24%|██▍       | 51/211 [21:04<1:06:21, 24.88s/it] 25%|██▍       | 52/211 [21:29<1:05:58, 24.90s/it] 25%|██▌       | 53/211 [21:54<1:05:21, 24.82s/it] 26%|██▌       | 54/211 [22:19<1:05:07, 24.89s/it] 26%|██▌       | 55/211 [22:44<1:04:42, 24.89s/it] 27%|██▋       | 56/211 [23:09<1:04:26, 24.95s/it] 27%|██▋       | 57/211 [23:33<1:03:47, 24.85s/it] 27%|██▋       | 58/211 [23:58<1:03:35, 24.93s/it] 28%|██▊       | 59/211 [24:23<1:03:06, 24.91s/it] 28%|██▊       | 60/211 [24:48<1:02:40, 24.91s/it]                                                   28%|██▊       | 60/211 [24:48<1:02:40, 24.91s/it] 29%|██▉       | 61/211 [25:13<1:02:16, 24.91s/it] 29%|██▉       | 62/211 [25:38<1:01:40, 24.84s/it] 30%|██▉       | 63/211 [26:03<1:01:23, 24.89s/it] 30%|███       | 64/211 [26:28<1:01:04, 24.93s/it] 31%|███       | 65/211 [26:53<1:00:29, 24.86s/it] 31%|███▏      | 66/211 [27:17<59:50, 24.76s/it]   32%|███▏      | 67/211 [27:42<59:30, 24.79s/it] 32%|███▏      | 68/211 [28:07<59:05, 24.80s/it] 33%|███▎      | 69/211 [28:32<58:42, 24.80s/it] 33%|███▎      | 70/211 [28:56<58:11, 24.76s/it] 34%|███▎      | 71/211 [29:21<57:43, 24.74s/it] 34%|███▍      | 72/211 [29:46<57:22, 24.77s/it] 35%|███▍      | 73/211 [30:11<57:08, 24.84s/it] 35%|███▌      | 74/211 [30:36<56:43, 24.85s/it] 36%|███▌      | 75/211 [31:00<56:12, 24.80s/it] 36%|███▌      | 76/211 [31:25<55:50, 24.82s/it] 36%|███▋      | 77/211 [31:50<55:32, 24.87s/it] 37%|███▋      | 78/211 [32:15<55:17, 24.94s/it] 37%|███▋      | 79/211 [32:40<54:48, 24.91s/it] 38%|███▊      | 80/211 [33:05<54:34, 25.00s/it]                                                 38%|███▊      | 80/211 [33:05<54:34, 25.00s/it] 38%|███▊      | 81/211 [33:30<54:05, 24.97s/it] 39%|███▉      | 82/211 [33:55<53:31, 24.90s/it] 39%|███▉      | 83/211 [34:20<52:57, 24.83s/it] 40%|███▉      | 84/211 [34:44<52:29, 24.80s/it] 40%|████      | 85/211 [35:09<52:05, 24.80s/it] 41%|████      | 86/211 [35:34<51:36, 24.78s/it] 41%|████      | 87/211 [35:59<51:13, 24.78s/it] 42%|████▏     | 88/211 [36:23<50:49, 24.79s/it] 42%|████▏     | 89/211 [36:49<50:44, 24.96s/it] 43%|████▎     | 90/211 [37:13<50:10, 24.88s/it] 43%|████▎     | 91/211 [37:38<49:40, 24.84s/it] 44%|████▎     | 92/211 [38:03<49:21, 24.89s/it] 44%|████▍     | 93/211 [38:28<48:37, 24.73s/it] 45%|████▍     | 94/211 [38:53<48:24, 24.82s/it] 45%|████▌     | 95/211 [39:17<47:47, 24.72s/it] 45%|████▌     | 96/211 [39:42<47:34, 24.83s/it] 46%|████▌     | 97/211 [40:07<47:11, 24.84s/it] 46%|████▋     | 98/211 [40:32<46:43, 24.81s/it] 47%|████▋     | 99/211 [40:56<46:11, 24.75s/it] 47%|████▋     | 100/211 [41:21<45:45, 24.73s/it]                                                  47%|████▋     | 100/211 [41:21<45:45, 24.73s/it] 48%|████▊     | 101/211 [41:46<45:32, 24.84s/it] 48%|████▊     | 102/211 [42:11<45:09, 24.86s/it] 49%|████▉     | 103/211 [42:36<44:50, 24.91s/it] 49%|████▉     | 104/211 [43:01<44:17, 24.84s/it] 50%|████▉     | 105/211 [43:26<43:50, 24.82s/it] 50%|█████     | 106/211 [43:50<43:25, 24.81s/it] 51%|█████     | 107/211 [44:16<43:18, 24.99s/it] 51%|█████     | 108/211 [44:41<43:07, 25.12s/it] 52%|█████▏    | 109/211 [45:07<42:51, 25.21s/it] 52%|█████▏    | 110/211 [45:31<42:08, 25.04s/it] 53%|█████▎    | 111/211 [45:56<41:32, 24.93s/it] 53%|█████▎    | 112/211 [46:21<41:03, 24.89s/it] 54%|█████▎    | 113/211 [46:46<40:43, 24.93s/it] 54%|█████▍    | 114/211 [47:11<40:18, 24.93s/it] 55%|█████▍    | 115/211 [47:35<39:48, 24.88s/it] 55%|█████▍    | 116/211 [48:00<39:20, 24.85s/it] 55%|█████▌    | 117/211 [48:25<38:58, 24.87s/it] 56%|█████▌    | 118/211 [48:50<38:31, 24.86s/it] 56%|█████▋    | 119/211 [49:14<37:57, 24.76s/it] 57%|█████▋    | 120/211 [49:39<37:27, 24.69s/it]                                                  57%|█████▋    | 120/211 [49:39<37:27, 24.69s/it] 57%|█████▋    | 121/211 [50:04<36:58, 24.65s/it] 58%|█████▊    | 122/211 [50:28<36:32, 24.64s/it] 58%|█████▊    | 123/211 [50:53<36:11, 24.67s/it] 59%|█████▉    | 124/211 [51:18<35:50, 24.72s/it] 59%|█████▉    | 125/211 [51:43<35:40, 24.89s/it] 60%|█████▉    | 126/211 [52:07<35:03, 24.75s/it] 60%|██████    | 127/211 [52:32<34:38, 24.75s/it] 61%|██████    | 128/211 [52:57<34:20, 24.83s/it] 61%|██████    | 129/211 [53:22<33:57, 24.85s/it] 62%|██████▏   | 130/211 [53:47<33:24, 24.75s/it] 62%|██████▏   | 131/211 [54:11<32:58, 24.73s/it] 63%|██████▎   | 132/211 [54:36<32:41, 24.82s/it] 63%|██████▎   | 133/211 [55:01<32:14, 24.80s/it] 64%|██████▎   | 134/211 [55:26<31:51, 24.82s/it] 64%|██████▍   | 135/211 [55:51<31:22, 24.77s/it] 64%|██████▍   | 136/211 [56:15<30:57, 24.77s/it] 65%|██████▍   | 137/211 [56:41<30:45, 24.94s/it] 65%|██████▌   | 138/211 [57:06<30:23, 24.98s/it] 66%|██████▌   | 139/211 [57:31<29:52, 24.90s/it] 66%|██████▋   | 140/211 [57:55<29:25, 24.87s/it]                                                  66%|██████▋   | 140/211 [57:55<29:25, 24.87s/it] 67%|██████▋   | 141/211 [58:20<29:06, 24.95s/it] 67%|██████▋   | 142/211 [58:46<28:49, 25.06s/it] 68%|██████▊   | 143/211 [59:10<28:16, 24.95s/it] 68%|██████▊   | 144/211 [59:36<27:53, 24.98s/it] 69%|██████▊   | 145/211 [1:00:01<27:30, 25.00s/it] 69%|██████▉   | 146/211 [1:00:26<27:06, 25.03s/it] 70%|██████▉   | 147/211 [1:00:51<26:49, 25.15s/it] 70%|███████   | 148/211 [1:01:16<26:18, 25.06s/it] 71%|███████   | 149/211 [1:01:41<25:51, 25.02s/it] 71%|███████   | 150/211 [1:02:06<25:22, 24.95s/it] 72%|███████▏  | 151/211 [1:02:30<24:54, 24.91s/it] 72%|███████▏  | 152/211 [1:02:55<24:27, 24.88s/it] 73%|███████▎  | 153/211 [1:03:20<24:01, 24.85s/it] 73%|███████▎  | 154/211 [1:03:45<23:35, 24.83s/it] 73%|███████▎  | 155/211 [1:04:10<23:10, 24.83s/it] 74%|███████▍  | 156/211 [1:04:35<22:48, 24.89s/it] 74%|███████▍  | 157/211 [1:05:00<22:24, 24.90s/it] 75%|███████▍  | 158/211 [1:05:24<21:54, 24.80s/it] 75%|███████▌  | 159/211 [1:05:49<21:35, 24.92s/it] 76%|███████▌  | 160/211 [1:06:14<21:09, 24.89s/it]                                                    76%|███████▌  | 160/211 [1:06:14<21:09, 24.89s/it] 76%|███████▋  | 161/211 [1:06:39<20:40, 24.82s/it] 77%|███████▋  | 162/211 [1:07:04<20:20, 24.90s/it] 77%|███████▋  | 163/211 [1:07:29<20:00, 25.01s/it] 78%|███████▊  | 164/211 [1:07:54<19:32, 24.95s/it] 78%|███████▊  | 165/211 [1:08:18<19:00, 24.80s/it] 79%|███████▊  | 166/211 [1:08:44<18:38, 24.86s/it] 79%|███████▉  | 167/211 [1:09:08<18:10, 24.78s/it] 80%|███████▉  | 168/211 [1:09:33<17:50, 24.90s/it] 80%|████████  | 169/211 [1:09:58<17:28, 24.97s/it] 81%|████████  | 170/211 [1:10:24<17:08, 25.08s/it] 81%|████████  | 171/211 [1:10:49<16:41, 25.03s/it] 82%|████████▏ | 172/211 [1:11:13<16:13, 24.96s/it] 82%|████████▏ | 173/211 [1:11:39<15:49, 24.99s/it] 82%|████████▏ | 174/211 [1:12:04<15:25, 25.00s/it] 83%|████████▎ | 175/211 [1:12:28<14:56, 24.91s/it] 83%|████████▎ | 176/211 [1:12:53<14:30, 24.87s/it] 84%|████████▍ | 177/211 [1:13:18<14:05, 24.88s/it] 84%|████████▍ | 178/211 [1:13:43<13:41, 24.88s/it] 85%|████████▍ | 179/211 [1:14:08<13:16, 24.90s/it] 85%|████████▌ | 180/211 [1:14:32<12:49, 24.81s/it]                                                    85%|████████▌ | 180/211 [1:14:32<12:49, 24.81s/it] 86%|████████▌ | 181/211 [1:14:57<12:25, 24.85s/it] 86%|████████▋ | 182/211 [1:15:22<12:03, 24.94s/it] 87%|████████▋ | 183/211 [1:15:47<11:35, 24.83s/it] 87%|████████▋ | 184/211 [1:16:12<11:11, 24.87s/it] 88%|████████▊ | 185/211 [1:16:37<10:48, 24.94s/it] 88%|████████▊ | 186/211 [1:17:02<10:21, 24.87s/it] 89%|████████▊ | 187/211 [1:17:27<09:58, 24.96s/it] 89%|████████▉ | 188/211 [1:17:52<09:35, 25.02s/it] 90%|████████▉ | 189/211 [1:18:17<09:09, 24.99s/it] 90%|█████████ | 190/211 [1:18:42<08:43, 24.94s/it] 91%|█████████ | 191/211 [1:19:07<08:19, 24.98s/it] 91%|█████████ | 192/211 [1:19:32<07:54, 24.96s/it] 91%|█████████▏| 193/211 [1:19:57<07:28, 24.93s/it] 92%|█████████▏| 194/211 [1:20:22<07:03, 24.94s/it] 92%|█████████▏| 195/211 [1:20:46<06:38, 24.91s/it] 93%|█████████▎| 196/211 [1:21:11<06:14, 24.94s/it] 93%|█████████▎| 197/211 [1:21:36<05:49, 24.94s/it] 94%|█████████▍| 198/211 [1:22:01<05:23, 24.88s/it] 94%|█████████▍| 199/211 [1:22:26<04:58, 24.85s/it] 95%|█████████▍| 200/211 [1:22:51<04:33, 24.85s/it]                                                    95%|█████████▍| 200/211 [1:22:51<04:33, 24.85s/it] 95%|█████████▌| 201/211 [1:23:16<04:08, 24.86s/it] 96%|█████████▌| 202/211 [1:23:41<03:43, 24.86s/it] 96%|█████████▌| 203/211 [1:24:05<03:18, 24.86s/it] 97%|█████████▋| 204/211 [1:24:30<02:53, 24.75s/it] 97%|█████████▋| 205/211 [1:24:55<02:29, 24.86s/it] 98%|█████████▊| 206/211 [1:25:20<02:04, 24.87s/it] 98%|█████████▊| 207/211 [1:25:45<01:39, 24.79s/it] 99%|█████████▊| 208/211 [1:26:09<01:14, 24.75s/it] 99%|█████████▉| 209/211 [1:26:35<00:49, 24.98s/it]100%|█████████▉| 210/211 [1:26:59<00:24, 24.89s/it]100%|██████████| 211/211 [1:27:03<00:00, 18.62s/it]/home/matteos/miniconda3/envs/trippy-cot/lib/python3.13/site-packages/peft/utils/save_and_load.py:300: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
                                                   100%|██████████| 211/211 [1:27:14<00:00, 18.62s/it]100%|██████████| 211/211 [1:27:14<00:00, 24.81s/it]
[2025-08-21 00:59:23,611] INFO - saving model and tokenizer to ../runs-sft/model-Qwen2.5-7B-Instruct/teacher-Meta-Llama-3-8B-Instruct/gsm8k-evaluate-first-test
/home/matteos/miniconda3/envs/trippy-cot/lib/python3.13/site-packages/peft/utils/save_and_load.py:300: UserWarning: Setting `save_embedding_layers` to `True` as the embedding layer has been resized during finetuning.
  warnings.warn(
[2025-08-21 00:59:33,296] INFO - Done.
{'loss': 0.7363, 'grad_norm': 0.3895890414714813, 'learning_rate': 0.0001982973099683902, 'num_tokens': 139537.0, 'mean_token_accuracy': 0.8546118970960379, 'epoch': 0.1}
{'loss': 0.0761, 'grad_norm': 0.2145049124956131, 'learning_rate': 0.00018810121942857845, 'num_tokens': 278377.0, 'mean_token_accuracy': 0.9827834668569266, 'epoch': 0.19}
{'loss': 0.0656, 'grad_norm': 0.15940076112747192, 'learning_rate': 0.0001696133945962927, 'num_tokens': 418174.0, 'mean_token_accuracy': 0.9847464287653566, 'epoch': 0.29}
{'loss': 0.0628, 'grad_norm': 0.20601876080036163, 'learning_rate': 0.00014457383557765386, 'num_tokens': 558433.0, 'mean_token_accuracy': 0.9857649993151426, 'epoch': 0.38}
{'loss': 0.06, 'grad_norm': 0.1649027317762375, 'learning_rate': 0.00011533916548786857, 'num_tokens': 697264.0, 'mean_token_accuracy': 0.9866478684358299, 'epoch': 0.48}
{'loss': 0.0598, 'grad_norm': 0.15374471247196198, 'learning_rate': 8.466083451213144e-05, 'num_tokens': 836985.0, 'mean_token_accuracy': 0.9869122305884958, 'epoch': 0.57}
{'loss': 0.06, 'grad_norm': 0.1376405507326126, 'learning_rate': 5.542616442234618e-05, 'num_tokens': 976315.0, 'mean_token_accuracy': 0.9868283470161259, 'epoch': 0.67}
{'loss': 0.0587, 'grad_norm': 0.1574418544769287, 'learning_rate': 3.0386605403707346e-05, 'num_tokens': 1116634.0, 'mean_token_accuracy': 0.9869019730947912, 'epoch': 0.76}
{'loss': 0.0593, 'grad_norm': 0.13560020923614502, 'learning_rate': 1.1898780571421552e-05, 'num_tokens': 1256456.0, 'mean_token_accuracy': 0.9869150428101421, 'epoch': 0.86}
{'loss': 0.059, 'grad_norm': 0.15787848830223083, 'learning_rate': 1.7026900316098215e-06, 'num_tokens': 1396846.0, 'mean_token_accuracy': 0.9868356356397271, 'epoch': 0.95}
{'train_runtime': 5234.5137, 'train_samples_per_second': 1.285, 'train_steps_per_second': 0.04, 'train_loss': 0.12599549361314819, 'num_tokens': 1467755.0, 'mean_token_accuracy': 0.9871499841029827, 'epoch': 1.0}
